<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Checkout - Walmart</title>
    <link rel="icon" href="https://www.walmart.com/favicon.ico" type="image/x-icon" />
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="payment.css">
</head>
<body>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Header -->
    <header class="checkout-header">
        <div class="header-content">
            <div class="header-left">
                <a href="../CheckoutDetailing/cart.html" class="back-link">
                    <i class="fas fa-arrow-left"></i>
                    <span>Back to Cart</span>
                </a>
            </div>
            <h1 class="checkout-title">
                <i class="fas fa-shield-alt"></i>
                Secure Checkout
            </h1>
            <div class="security-badge">
                <i class="fas fa-lock"></i>
                <span>SSL Secured</span>
            </div>
        </div>
    </header>

    <!-- Progress Indicator -->
    <div class="progress-container">
        <div class="progress-content">
            <div class="progress-bar">
                <div class="progress-step completed">
                    <div class="step-number">
                        <i class="fas fa-check"></i>
                    </div>
                    <span class="step-label">Cart</span>
                </div>
                <div class="progress-step active">
                    <div class="step-number">2</div>
                    <span class="step-label">Checkout</span>
                </div>
                <div class="progress-step">
                    <div class="step-number">3</div>
                    <span class="step-label">Confirmation</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main id="main-content" class="main-container">
        <!-- Left Column -->
        <div class="checkout-left">
            <!-- Shipping Section -->
            <section class="checkout-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-truck"></i>
                        1. Shipping Information
                    </h2>
                    <div class="section-status completed">
                        <i class="fas fa-check-circle"></i>
                        <span>Complete</span>
                    </div>
                </div>
                <div class="section-content">
                    <div class="shipping-info">
                        <div class="shipping-icon">
                            <img src="https://i5.walmartimages.com/dfw/63fd9f59-1b5e/5452ae02-a31f-4ef1-9a45-62ac0b06c13b/v1/mci-shipping.svg" alt="Free Shipping">
                        </div>
                        <div class="shipping-details">
                            <h3>Free shipping, arrives by Fri, Dec 25</h3>
                            <p>Your order qualifies for free standard shipping</p>
                        </div>
                    </div>
                    
                    <div class="address-card">
                        <div class="address-header">
                            <h4>Delivery Address</h4>
                            <button class="edit-btn" onclick="editAddress()">
                                <i class="fas fa-edit"></i>
                                Edit
                            </button>
                        </div>
                        <div class="address-details">
                            <p class="recipient-name">Rajshree Rajoliya</p>
                            <p class="address-line">Golden Gate Bridge, SF, CA 94016</p>
                        </div>
                    </div>
                    
                    <div class="delivery-instructions">
                        <h4>Delivery Instructions</h4>
                        <p>Add gate codes or other useful information</p>
                        <button class="add-instructions-btn" onclick="addInstructions()">
                            <i class="fas fa-plus"></i>
                            Add Instructions
                        </button>
                    </div>
                </div>
            </section>

            <!-- Items Section -->
            <section class="checkout-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-box"></i>
                        Order Items
                    </h2>
                    <div class="items-count">
                        <span id="totalItems">0</span> items
                    </div>
                </div>
                <div class="section-content p-0">
                    <div id="cartDetails" class="space-y-4 p-4">
                        <!-- Cart items will be populated here -->
                    </div>
                </div>
            </section>

            <!-- Payment Section -->
            <section class="checkout-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-credit-card"></i>
                        2. Payment Method
                    </h2>
                </div>
                <div class="section-content">
                    <div class="payment-methods">
                        <h3>Choose your payment method</h3>
                        <div class="payment-options">
                            <div class="payment-option" onclick="selectPaymentMethod('card')">
                                <input type="radio" name="payment" id="card-payment" value="card" checked>
                                <label for="card-payment">
                                    <i class="fas fa-credit-card"></i>
                                    Credit/Debit Card
                                </label>
                            </div>
                            <div class="payment-option" onclick="selectPaymentMethod('paypal')">
                                <input type="radio" name="payment" id="paypal-payment" value="paypal">
                                <label for="paypal-payment">
                                    <i class="fab fa-paypal"></i>
                                    PayPal
                                </label>
                            </div>
                            <div class="payment-option" onclick="selectPaymentMethod('gift')">
                                <input type="radio" name="payment" id="gift-payment" value="gift">
                                <label for="gift-payment">
                                    <i class="fas fa-gift"></i>
                                    Gift Card
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="accepted-cards">
                        <h4>We accept</h4>
                        <div class="card-logos">
                            <img src="https://i5.walmartimages.com/dfw/63fd9f59-18df/ed0b73d0-0bbd-44dc-8dcc-b835c7588ece/v1/wallet-visa-dark-logo.png" alt="Visa">
                            <img src="https://i5.walmartimages.com/dfw/63fd9f59-18df/ed0b73d0-0bbd-44dc-8dcc-b835c7588ece/v1/wallet-master-dark-logo.png" alt="Mastercard">
                            <img src="https://i5.walmartimages.com/dfw/4ff9c6c9-213b/k2-_d4c88659-0d50-4007-9562-22aa7e463fcb.v1.svg" alt="American Express">
                            <img src="https://i5.walmartimages.com/dfw/63fd9f59-18df/ed0b73d0-0bbd-44dc-8dcc-b835c7588ece/v1/wallet-discover-dark-logo.png" alt="Discover">
                            <img src="https://i5.walmartimages.com/dfw/63fd9f59-154b/e8c1d0bf-a4ad-4b20-8eac-939ab7f93063/v1/Gift-Card-Logo.png" alt="Gift Card">
                        </div>
                    </div>

                    <div class="card-form" id="cardForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cardNumber">Card Number *</label>
                                <div class="input-wrapper">
                                    <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" required>
                                    <i class="fas fa-credit-card input-icon"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expiryDate">Expiry Date *</label>
                                <input type="text" id="expiryDate" placeholder="MM/YY" maxlength="5" required>
                            </div>
                            <div class="form-group">
                                <label for="cvv">CVV *</label>
                                <div class="input-wrapper">
                                    <input type="text" id="cvv" placeholder="123" maxlength="4" required>
                                    <i class="fas fa-question-circle cvv-help" title="3-4 digits on the back of your card"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="cardName">Name on Card *</label>
                            <input type="text" id="cardName" placeholder="John Doe" required>
                        </div>
                    </div>

                    <div class="payment-info">
                        <p><i class="fas fa-info-circle"></i> Your payment information is encrypted and secure</p>
                        <a href="#" class="learn-more">Learn more about our security measures</a>
                    </div>
                </div>
            </section>
             <!-- Delivery Preferences Section -->
             <section class="checkout-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-truck"></i>
                        Delivery Preferences
                    </h2>
                </div>
                <div class="section-content">
                    <div class="delivery-options">
                        <h3>Choose your delivery speed</h3>
                        
                        <!-- Delivery Options Container -->
                        <div class="delivery-options-container">
                            <!-- Standard Delivery Option -->
                            <div class="delivery-option" id="standardDelivery">
                                <input type="radio" name="deliveryOption" id="standard" value="standard">
                                <label for="standard">
                                    <span class="option-title">Standard Delivery</span>
                                    <span class="option-price">Free</span>
                                    <span class="delivery-time">3-5 business days</span>
                                </label>
                                <div class="option-details">
                                    <p>Regular shipping with standard carbon footprint</p>
                                </div>
                            </div>

                            <!-- Eco Delivery Card -->
                            <div class="eco-delivery-card">
                                <div class="eco-delivery-header">
                                    <label class="eco-radio">
                                        <input type="radio" name="deliveryOption" id="eco" value="eco">
                                        <span class="radio-custom"></span>
                                    </label>
                                <div class="eco-title">
                                    <i class="fas fa-leaf"></i> Eco-Delivery
                                    <span class="eco-delivery-time">(5-8 business days)</span>
                                </div>
                                <div class="eco-price-tag">
                                    <span class="eco-original-price">$1 </span>
                                    <span class="eco-discount">FREE</span>
                                </div>
                            </div>
                            <div class="eco-benefits">
                                <div class="eco-benefit-item">
                                    <i class="fas fa-leaf"></i>
                                    <div>40% lower carbon footprint</div>
                                </div>
                                <div class="eco-benefit-item">
                                    <i class="fas fa-truck"></i>
                                    <div>Road transport only</div>
                                </div>
                                <div class="eco-benefit-item">
                                    <i class="fas fa-gift"></i>
                                    <div>
                                        Earn <span class="ecopoints-badge"><i class="fas fa-award"></i> 50 EcoPoints</span>
                                    </div>
                                </div>
                                <div class="eco-savings">
                                    <i class="fas fa-tag"></i> $1 Discount Applied (was $1 )
                                </div>
                            </div>
                        </div>

                            </div>
                        </div>

                        <!-- Tree Donation Card -->
                        <div class="donation-card">
                            <div class="donation-checkbox">
                                <input type="checkbox" id="treeDonation">
                                <span class="checkmark"></span>
                            </div>
                            <div class="donation-content">
                                <div class="donation-title">
                                    <i class="fas fa-tree"></i> Donate $1 to plant a tree
                                    <span class="ecopoints-badge"><i class="fas fa-award"></i> +30 EcoPoints</span>
                                </div>
                                <div class="donation-subtitle">
                                    Your $1 helps reforest India. Join the change!
                                </div>
                            </div>
                        </div>
                        <!-- Batch Delivery Option -->
                        <div class="batch-delivery-card">
                            <div class="batch-delivery-header">
                              <label class="batch-radio">
                                <input type="checkbox" id="batchDelivery">
                                <span class="radio-custom"></span>
                              </label>
                              <div class="batch-title">
                                <i class="fas fa-boxes"></i> Combine with Future Orders
                              </div>
                              <div class="batch-price-tag">
                                <span class="batch-discount">+25 EcoPoints</span>
                                <span class="info-tooltip" title="Save on packaging and reduce carbon emissions by combining multiple orders into one delivery">
                                  <i class="fas fa-info-circle"></i>
                                </span>
                              </div>
                            </div>
                          
                            <div class="batch-benefits">
                            <div class="batch-benefit-item">
                                <i class="fas fa-leaf"></i>
                                <div>Your Total CO2e by logistics is: <span id="total-logistics-impact">0</span></div>
                            </div>
                            <div class="batch-benefit-item">
                                <i class="fas fa-leaf"></i>
                                <div>If you opt for combining future orders together you will reduce Logistics CO2e by 60%</div>
                            </div>
                            <div class="batch-benefit-item">
                                <i class="fas fa-coins"></i>
                                <div>Earn <span class="ecopoints-badge"><i class="fas fa-award"></i> 25 EcoPoints</span></div>
                            </div>
                        </div>
                        </div>
                        <!-- EcoPoints Summary -->
                        <div class="ecopoints-summary">
                            <div class="ecopoints-header">
                                <i class="fas fa-award"></i>
                                <h4>EcoPoints Earned This Order</h4>
                            </div>
                            <div class="ecopoints-details">
                                <div class="ecopoints-row">
                                    <span>Eco Product Choice:</span>
                                    <span class="ecopoints-amount" id="ecoproducts-points">+25</span>
                                  </div>
                                <div class="ecopoints-row">
                                    <span>Eco-Delivery:</span>
                                    <span class="ecopoints-amount" id="ecodelivery-points">+50</span>
                                </div>
                                <div class="ecopoints-row">
                                    <span>Tree Donation:</span>
                                    <span class="ecopoints-amount" id="donation-points">+30</span>
                                </div>
                                <div class="ecopoints-row">
                                    <span>Batch Delivery:</span>
                                    <span class="ecopoints-amount" id="batch-points">+25</span>
                                  </div>

                                <div class="ecopoints-total">
                                    <span>Total:</span>
                                    <span class="ecopoints-amount" id="total-ecopoints">80 EcoPoints</span>
                                </div>
                            </div>
                        </div>
                    </div>
            </section>
            <!-- Contact Section -->
            <section class="checkout-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-mobile-alt"></i>
                        3. Contact Information
                    </h2>
                    <div class="section-status completed">
                        <i class="fas fa-check-circle"></i>
                        <span>Complete</span>
                    </div>
                </div>
                <div class="section-content">
                    <p class="contact-info">We'll contact you if anything comes up with your order.</p>
                    
                    <div class="form-group">
                        <label for="phoneNumber">Phone Number *</label>
                        <div class="phone-input">
                            <select class="country-code">
                                <option value="+1">+1</option>
                                <option value="+44">+44</option>
                                <option value="+91">+91</option>
                            </select>
                            <input type="tel" id="phoneNumber" placeholder="(555) 123-4567" required>
                        </div>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="saveInfo" checked>
                        <label for="saveInfo">Save my information for a faster checkout</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="smsUpdates" checked>
                        <label for="smsUpdates">
                            <i class="fas fa-sms"></i>
                            I want to receive text updates about my order status
                        </label>
                    </div>
                    
                    <div class="terms-notice">
                        <p>Message and data rates may apply. By continuing, you agree to our <a href="#">Mobile Alert Terms</a>.</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- Right Column - Order Summary -->
        <div class="checkout-right">
            <div class="order-summary">
                <!-- Savings Banner -->
                <div class="savings-banner" id="savingsBanner">
                    <div class="savings-content">
                        <div class="savings-icon">
                            <img src="https://i5.walmartimages.com/dfw/4ff9c6c9-69ed/k2-_c5fc89eb-a765-445a-846c-c88b31ebf4f2.v1.png" alt="Savings">
                        </div>
                        <div class="savings-text">
                            <h4>Great Savings!</h4>
                            <p>Items in your cart have reduced prices. Check out now for extra savings!</p>
                        </div>
                        <button class="close-savings" onclick="closeSavingsBanner()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <!-- Order Summary Details -->
                <div class="summary-content">
                    <h3 class="summary-title">Order Summary</h3>
                    
                    <!-- Cart Items -->
                    <div id="order-items" class="order-items">
                        <!-- Items will be dynamically inserted here -->
                    </div>
                    <div class="summary-divider"></div>
                    
                    <div class="order-summary-row">
                        <span class="summary-label">Subtotal (<span id="item-count">0</span> items)</span>
                        <span class="summary-value" id="subtotal-amount">$0.00</span>
                    </div>
                    
                    <div class="order-summary-row savings-row">
                        <span class="summary-label">Shipping</span>
                        <span class="summary-value" id="shipping-amount">$0.00</span>
                    </div>
                    
                    <div class="order-summary-row">
                        <span class="summary-label">Estimated Tax</span>
                        <span class="summary-value" id="tax-amount">$0.00</span>
                    </div>
                    
                    <div class="summary-divider"></div>
                    
                    <div class="order-summary-row total-row">
                        <span class="summary-label">Estimated Total</span>
                        <span class="summary-value" id="estimated-total">$0.00</span>
                    </div>
                    
                    <div class="financing-info">
                        <p>
                            <span>$32/mo with </span>
                            <img src="https://cdn-assets.affirm.com/images/black_logo-white_bg.jpg" alt="Affirm" class="affirm-logo">
                        </p>
                        <a href="#" class="learn-how">Learn how</a>
                    </div>
                    
                    <button class="checkout-btn" id="buttonContinue">
                        <i class="fas fa-lock"></i>
                        Complete Order
                    </button>
                    
                    <div class="security-notice">
                        <i class="fas fa-shield-alt"></i>
                        <span>Your order is protected by SSL encryption</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Processing your order...</p>
        </div>
    </div>

    <script>
        // Load cart items and update order summary
        document.addEventListener('DOMContentLoaded', function() {
            const cart = JSON.parse(localStorage.getItem('walmartCart')) || [];
            const orderItemsContainer = document.getElementById('order-items');
            const itemCountElement = document.getElementById('item-count');
            const subtotalElement = document.getElementById('subtotal-amount');
            const shippingElement = document.getElementById('shipping-amount');
            const taxElement = document.getElementById('tax-amount');
            const totalElement = document.getElementById('estimated-total');
            
            let subtotal = 0;
            let itemCount = 0;
            
            // Clear existing items
            orderItemsContainer.innerHTML = '';
            
            if (cart.length === 0) {
                const emptyCart = document.createElement('div');
                emptyCart.className = 'empty-cart-message';
                emptyCart.textContent = 'Your cart is empty';
                orderItemsContainer.appendChild(emptyCart);
            } else {
                // Add each cart item to the order summary
                    cart.forEach(item => {
                    // Calculate price (handle both price and Sale_Price properties)
                    let price = 0;
                    if (item.price) {
                        price = typeof item.price === 'string' 
                            ? parseFloat(item.price.replace(/[^0-9.-]+/g, '')) 
                            : item.price;
                    } else if (item.Sale_Price) {
                        price = typeof item.Sale_Price === 'string'
                            ? parseFloat(item.Sale_Price.replace(/[^0-9.-]+/g, ''))
                            : item.Sale_Price;
                    }
                    
                    const name = item.title || item.Product_Name || 'Product';
                    const image = item.image || item.Product_imgUrl || 'https://via.placeholder.com/100';
                    const quantity = item.count || 1;
                    const itemTotal = price * quantity;
                    
                    subtotal += itemTotal;
                    itemCount += quantity;
                    
                    const itemElement = document.createElement('div');
                    itemElement.className = 'order-item';
                    itemElement.innerHTML = `
                        <div class="order-item-image">
                            <img src="${image}" alt="${name}">
                            <span class="item-quantity">${quantity}</span>
                        </div>
                        <div class="order-item-details">
                            <h4>${name}</h4>
                            <div class="item-price">$${price.toFixed(2)} × ${quantity}</div>
                        </div>
                        <div class="order-item-total">$${itemTotal.toFixed(2)}</div>
                    `;
                    orderItemsContainer.appendChild(itemElement);
                });
            }
            
            // Update summary
            itemCountElement.textContent = itemCount;
            subtotalElement.textContent = `$${subtotal.toFixed(2)}`;
            
            // Calculate shipping (free over $35)
            const shipping = subtotal >= 35 ? 0 : 6.99;
            shippingElement.textContent = `$${shipping.toFixed(2)}`;
            
            // Calculate tax (estimate 8% for demo)
            const tax = subtotal * 0.08;
            taxElement.textContent = `$${tax.toFixed(2)}`;
            
            // Calculate total
            const total = subtotal + shipping + tax;
            totalElement.textContent = `$${total.toFixed(2)}`;
            
            // Update the button text if cart is empty
            if (itemCount === 0) {
                const checkoutBtn = document.getElementById('buttonContinue');
                if (checkoutBtn) {
                    checkoutBtn.disabled = true;
                    checkoutBtn.textContent = 'Your cart is empty';
                }
            }
        });
    </script>
    
    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="modal-header">
                <i class="fas fa-check-circle success-icon"></i>
                <h2>Order Placed Successfully!</h2>
            </div>
            <div class="modal-body">
                <p>Thank you for your order. You will receive a confirmation email shortly.</p>
                <div class="order-number">
                    <strong>Order #: <span id="orderNumber"></span></strong>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="goToOrderConfirmation()">View Order Details</button>
            </div>
        </div>
    </div>

    <script src="payment.js"></script>
</body>
</html>
